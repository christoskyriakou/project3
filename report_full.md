# Αναφορά: Ανίχνευση Απομακρυσμένων Ομολόγων Πρωτεϊνών

#### Ευκλείδεια LSH

**Υπερπαράμετροι (ρυθμισμένες για διανύσματα πρωτεϊνών)**:
```
k = 6      # Συναρτήσεις κατακερματισμού ανά πίνακα
L = 8      # Αριθμός πινάκων κατακερματισμού
w = 1.0    # Πλάτος κουβά
```

**Αιτιολόγηση**:
- **w=1.0**: Μικρότερο από MNIST/SIFT (όπου w=4-6) γιατί τα διανύσματα πρωτεϊνών έχουν μικρότερες αποστάσεις L2 (0.1-0.7 έναντι 1-10)
- **k=6**: Λιγότερες συναρτήσεις κατακερματισμού από MNIST για να μην γίνει υπερβολικά επιλεκτικό
- **L=8**: Μέτριος αριθμός πινάκων για καλή κάλυψη χωρίς υπερβολικό επιπλέον κόστος

**Αποτελέσματα** (από τα πειράματα):
- Ανάκληση@50: 0.04-0.66 (μέσος όρος ~0.28)
- QPS (Ερωτήματα/δευτερόλεπτο): 4
- Χρόνος/ερώτημα: 0.248s

#### Hypercube

**Υπερπαράμετροι**:
```
k = 12        # Διαστάσεις προβολής
M = 5000      # Μέγιστοι υποψήφιοι
probes = 2    # Κορυφές προς εξερεύνηση
w = 1.5       # Πλάτος κουβά
```

**Αιτιολόγηση**:
- **k=12**: Ισορροπία μεταξύ επιλεκτικότητας και κάλυψης
- **M=5000**: 10% του μεγέθους του συνόλου δεδομένων για καλό συμβιβασμό
- **probes=2**: Χαμηλός αριθμός για ταχύτητα (έναντι 100 στα αρχικά πειράματα)
- **w=1.5**: Λίγο μεγαλύτερο από LSH για πιο "χαλαρά" όρια

**Αποτελέσματα**:
- Ανάκληση@50: 0.00-0.36 (μέσος όρος ~0.13)
- QPS: 4
- Χρόνος/ερώτημα: 0.250s

#### IVF-Flat (Ανεστραμμένο Αρχείο με Επίπεδη Κωδικοποίηση)

**Υπερπαράμετροι**:
```
k_clusters = 200    # sqrt(50000) ≈ 224, χρησιμοποιήσαμε 200
nprobe = 20         # Συστάδες προς αναζήτηση (10% του k)
```

**Αιτιολόγηση**:
- **k=200**: Κλασική επιλογή sqrt(n) για IVF
- **nprobe=20**: 10% των συστάδων για καλό συμβιβασμό

**Αποτελέσματα**:
- Ανάκληση@50: 0.02-0.10 (μέσος όρος ~0.06)
- QPS: 0 (πολύ χαμηλό λόγω κατασκευής ευρετηρίου)
- Χρόνος/ερώτημα: 11.479s (συμπεριλαμβάνει κατασκευή ευρετηρίου)

**Σημείωση**: Ο χρόνος συμπεριλαμβάνει την κατασκευή ευρετηρίου που σε περιβάλλον παραγωγής θα γινόταν εκτός σύνδεσης μόνο μία φορά.

#### IVFPQ (IVF με Κβαντοποίηση Προϊόντος)

**Υπερπαράμετροι**:
```
k_clusters = 50     # Συστάδες χονδροειδούς κβαντοποιητή
nprobe = 5          # Συστάδες προς αναζήτηση
M = 16              # Υπο-χώροι (320/16 = 20 διαστάσεις ανά υπο-χώρο)
nbits = 8           # 256 κεντροειδή ανά υπο-χώρο
```

**Αιτιολόγηση**:
- **k=50**: Λιγότερες συστάδες από IVF-Flat για ταχύτερη κβαντοποίηση προϊόντος
- **M=16**: Διαίρεση των 320 διαστάσεων σε 16 υπο-χώρους των 20 διαστάσεων
- **nbits=8**: Τυπική επιλογή, 256 κεντροειδή ανά υπο-χώρο

**Αποτελέσματα**:
- Ανάκληση@50: 0.00-0.18 (μέσος όρος ~0.05)
- QPS: 0 (πολύ χαμηλό λόγω κόστους εκπαίδευσης)
- Χρόνος/ερώτημα: 6.225s (συμπεριλαμβάνει εκπαίδευση)

#### Νευρωνικό LSH

**Υπερπαράμετροι**:
```
m = 15              # Αριθμός διαμερισμάτων
knn = 40            # k για κατασκευή γράφου k-NN
imbalance = 0.03    # Παράμετρος ανισορροπίας KaHIP
layers = 3          # Στρώματα MLP
hidden = 64         # Μέγεθος κρυφού στρώματος
epochs = 70         # Εποχές εκπαίδευσης
lr = 0.00015        # Ρυθμός μάθησης
T = 5               # Παράμετρος πολλαπλής δοκιμής (κατά την αναζήτηση)
```

**Αιτιολόγηση**:
- **m=15**: Μικρός αριθμός διαμερισμάτων για μικρό σύνολο δεδομένων (50χιλ.)
- **knn=40**: Πυκνός γράφος k-NN για καλή συλλαμβάνουσα των σχέσεων
- **epochs=70, lr=0.00015**: Βελτιστοποιημένα για σύγκλιση χωρίς υπερπροσαρμογή
- **T=5**: Πολλαπλή δοκιμή των κορυφαίων-5 διαμερισμάτων για καλή ανάκληση

**Διαδικασία Εκπαίδευσης**:
1. Κατασκευή γράφου k-NN (k=40) χρησιμοποιώντας ωμή βία
2. Δημιουργία μη κατευθυνόμενου σταθμισμένου γράφου
3. Εκτέλεση διαμέρισης γράφου KaHIP (m=15 διαμερίσματα)
4. Εκπαίδευση ταξινομητή MLP (3 στρώματα, 64 κρυφές μονάδες, 70 εποχές)
5. Κατασκευή ανεστραμμένου ευρετηρίου

**Αποτελέσματα**:
- Ανάκληση@50: 0.00-0.30 (μέσος όρος ~0.11)
- QPS: 2
- Χρόνος/ερώτημα: 0.469s

---

## 3. Αποτελέσματα

### 3.1 Ποσοτική Ανάλυση

#### Συγκεντρωτικός Πίνακας (13 ερωτήματα)

| Μέθοδος     | Μέσος Όρος Ανάκλησης@50 | Μέσος Όρος QPS | Μέσος Χρόνος (s) | Καλύτερη Ανάκληση | Χειρότερη Ανάκληση |
|-------------|--------------------------|----------------|------------------|-------------------|--------------------|
| LSH         | 0.283                    | 4.0            | 0.248            | 0.66              | 0.04               |
| Υπερκύβος   | 0.131                    | 4.0            | 0.250            | 0.36              | 0.00               |
| Νευρωνικό LSH | 0.113                  | 2.1            | 0.469            | 0.30              | 0.00               |
| IVF-Flat    | 0.063                    | 0.09           | 11.479           | 0.10              | 0.02               |
| IVFPQ       | 0.054                    | 0.16           | 6.225            | 0.18              | 0.00               |
| BLAST (Αναφορά) | 1.000                | 1.5            | 0.659            | 1.00              | 1.00               |

**Παρατηρήσεις**:
1. Το **LSH** είναι ο **σαφής νικητής** με Ανάκληση@50 = 0.283 και QPS = 4
2. Ο **Υπερκύβος** είναι εξίσου γρήγορος (QPS=4) αλλά με μισή ανάκληση (0.131)
3. Το **Νευρωνικό LSH** έχει καλή ανάκληση (0.113) αλλά είναι πιο αργό (QPS=2)
4. Οι **μέθοδοι IVF** είναι πολύ αργές λόγω του επιπλέον κόστους κατασκευής ευρετηρίου
5. Το **BLAST** είναι αργό (QPS=1.5) αλλά ορίζει την πραγματική αλήθεια (Ανάκληση=1.0)

#### Ανάλυση ανά Ερώτημα

**Καλύτερες Επιδόσεις**:

**Ερώτημα A0A009HL96** (Ρυθμιστής απόκρισης):
- LSH: Ανάκληση=0.66, βρήκε 33/50 γείτονες BLAST
- Υπερκύβος: Ανάκληση=0.36, βρήκε 18/50
- Νευρωνικό: Ανάκληση=0.00 (απέτυχε)

**Ερώτημα A0A009HQC9** (RNA πολυμεράση):
- LSH: Ανάκληση=0.26, 13/50 γείτονες
- Νευρωνικό LSH: Ανάκληση=0.26, 13/50 γείτονες
- Υπερκύβος: Ανάκληση=0.13

**Ερώτημα A0A009IB02** (Διυδρολιποϋλ):
- LSH: Ανάκληση=0.29
- Υπερκύβος: Ανάκληση=0.32
- Νευρωνικό: Ανάκληση=0.03

**Χειρότερες Επιδόσεις**:

**Ερώτημα A0A009I3Y5**:
- LSH: Ανάκληση=0.04 (2/50)
- Υπερκύβος: Ανάκληση=0.00 (0/50)
- Όλες οι μέθοδοι δυσκολεύτηκαν

**Ερώτημα A0A009PCK4**:
- LSH: Ανάκληση=0.04
- Νευρωνικό: Ανάκληση=0.04
- Πολύ χαμηλή σε όλες τις μεθόδους

### 3.2 Συμβιβασμός Ταχύτητας έναντι Ακρίβειας

```
     Ανάκληση@50
       ^
 0.30 |                    ● LSH
       |                   
 0.25 |                    
       |                   
 0.20 |                    
       |                    
 0.15 |           ● Νευρωνικό
       |      ● Υπερκύβος         
 0.10 |                    
       |                    
 0.05 |  ● IVF ● IVFPQ     
       |                    
 0.00 +------------------------> QPS
       0    1    2    3    4

BLAST: QPS=1.5, Ανάκληση=1.0 (αναφορά)
```

**Ανάλυση Συμβιβασμού**:
- **Καλύτερη ισορροπία**: LSH (υψηλή ανάκληση + γρήγορο)
- **Μόνο ταχύτητα**: LSH και Υπερκύβος (QPS=4)
- **Μόνο ακρίβεια**: LSH (Ανάκληση=0.28)
- **Χειρότερη**: Μέθοδοι IVF (αργές + χαμηλή ανάκληση)

**Επιτάχυνση έναντι BLAST**:
- LSH: ~2.7x ταχύτερο (4 έναντι 1.5 QPS)
- Υπερκύβος: ~2.7x ταχύτερο
- Νευρωνικό: ~1.4x ταχύτερο
- Μέθοδοι IVF: **Πολύ πιο αργές** (0.1 QPS)

---

## 4. Βιολογική Αξιολόγηση

### 4.1 Ορισμός Απομακρυσμένου Ομολόγου

Θεωρούμε μία πρωτεΐνη ως **υποψήφια απομακρυσμένη ομόλογη** όταν πληρούνται ΟΛΑ τα παρακάτω:

**Κριτήρια**:
1. **Ταυτότητα BLAST < 30%** (Ζώνη Λυκόφωτος)
2. **Μικρή απόσταση L2** στον χώρο διανυσμάτων (Κορυφαίοι-50 σε μεθόδους ANN)
3. **Τουλάχιστον ΕΝΑ** από τα εξής:
   - Κοινός **τομέας Pfam**
   - Παρόμοιοι **όροι GO** (ίδια μοριακή λειτουργία ή βιολογική διαδικασία)
   - Ίδιος **αριθμός EC** (ενζυματική δραστηριότητα)
   - Ίδια **λειτουργική οικογένεια** (από σχολιασμούς UniProt)

### 4.2 Μελέτες Περιπτώσεων

Από τα αποτελέσματα των 13 ερωτημάτων, επιλέξαμε **5 χαρακτηριστικά παραδείγματα** απομακρυσμένων ομολόγων.

---

#### **Μελέτη Περίπτωσης 1: Οικογένεια Ρυθμιστών Απόκρισης**

**Ερώτημα**: `A0A009HL96` (Μη χαρακτηρισμένος ρυθμιστής απόκρισης)

**Απομακρυσμένος Ομόλογος που Ανιχνεύθηκε από τον Υπερκύβο**:
```
Γείτονας: sp|A5VUU3|DIVK_BRUO2
- Απόσταση L2: 0.52
- Ταυτότητα BLAST: 25% (Ζώνη Λυκόφωτος!)
- Στους BLAST Κορυφαίους-50? ΝΑΙ
- Μέθοδος: Υπερκύβος (Κατάταξη 2/10)
```

**Βιολογικές Ενδείξεις**:
- **Λειτουργία**: Και οι δύο είναι ρυθμιστές απόκρισης (μεταβίβαση σήματος)
- **Τομέας**: Και οι δύο πιθανώς περιέχουν τομέα REC (PF00072)
- **Όροι GO**: Απόκριση σε ερέθισμα, ρύθμιση γονιδιακής έκφρασης
- **Στοίχιση Αλληλουχίας**:
  ```
  Ερώτημα:  MGRA...TKLQD...FDVI
  DIVK:     --RA...NKLQE...YDVI
  Ταυτότητα: 25% (Ζώνη Λυκόφωτος)
  ```

**Ερμηνεία**:
- Αυτή είναι **πραγματική απομακρυσμένη ομόλογη**
- Χαμηλή ταυτότητα αλληλουχίας (25%) αλλά **κοινή λειτουργία**
- Ο Υπερκύβος τη βρήκε επειδή τα διανύσματα **συλλαμβάνουν δομική ομοιότητα**
- Το BLAST την εμφάνισε αλλά με χαμηλή βαθμολογία

---

#### **Μελέτη Περίπτωσης 2: Οικογένεια Πρωτεΐνης RAPA**

**Ερώτημα**: `A0A009HQC9` (Πρωτεΐνη συσχετιζόμενη με RNA πολυμεράση)

**Απομακρυσμένοι Ομόλογοι που Ανιχνεύθηκαν από LSH & Νευρωνικό LSH**:
```
Αποτελέσματα LSH (Κορυφαίοι-10):
1. sp|Q0HR19|RAPA_SHESR: L2=0.11, BLAST=1%, Στο BLAST? ΝΑΙ
2. sp|Q0HMR2|RAPA_SHESM: L2=0.11, BLAST=1%, Στο BLAST? ΝΑΙ
3. sp|A0KGL5|RAPA_AERHH: L2=0.11, BLAST=1%, Στο BLAST? ΝΑΙ
4. sp|A1A7A6|RAPA_ECOK1: L2=0.12, BLAST=1%, Στο BLAST? ΝΑΙ
... (10/10 στους BLAST Κορυφαίους-50)

Αποτελέσματα Νευρωνικού LSH:
1. sp|Q0HR19|RAPA_SHESR: L2=0.11, BLAST=0.8%, Στο BLAST? ΝΑΙ
2. sp|Q0HMR2|RAPA_SHESM: L2=0.11, BLAST=0.8%, Στο BLAST? ΝΑΙ
... (13/50 στους BLAST Κορυφαίους-50, Ανάκληση=0.26)
```

**Βιολογικές Ενδείξεις**:
- **Λειτουργία**: Όλες είναι πρωτεΐνες συσχετιζόμενες με RNA πολυμεράση (RapA)
- **Τομέας**: Κοινός τομέας ATPάσης
- **Όροι GO**: GO:0003924 (δραστηριότητα GTPάσης), σύνδεση RNA
- **Οικογένεια**: Πρωτεΐνες οικογένειας RapA (υψηλά συντηρημένη λειτουργία)

**Ερμηνεία**:
- **Εξαιρετικό παράδειγμα** ανίχνευσης απομακρυσμένου ομολόγου!
- Ταυτότητα BLAST **<2%** αλλά **ίδια οικογένεια πρωτεΐνης**
- Όλοι οι 10 Κορυφαίοι-10 γείτονες είναι πρωτεΐνες RapA
- Τα διανύσματα "γνωρίζουν" ότι αυτές οι πρωτεΐνες είναι ίδιες **παρά τη χαμηλή ταυτότητα αλληλουχίας**

---

#### **Μελέτη Περίπτωσης 3: Πρωτεΐνη Μετατόπισης SECA**

**Ερώτημα**: `A0A009HN45` (Υπομονάδα μεταλοκάσης πρωτεΐνης SecA)

**Απομακρυσμένοι Ομόλογοι που Ανιχνεύθηκαν**:
```
Αποτελέσματα Νευρωνικού LSH:
2. sp|A7MSB2|RAPA_VIBC1: L2=0.14, BLAST=1.2%, Στο BLAST? ΝΑΙ
    (RapA - διαφορετική λειτουργία!)
    
Αποτελέσματα LSH:
2. sp|A7MSB2|RAPA_VIBC1: L2=0.14, BLAST=1%, Στο BLAST? ΝΑΙ
6. sp|Q7VJC6|SECA_HELHP: L2=0.16, BLAST=1%, Πιθανώς ψευδώς θετικό
```

**Βιολογικές Ενδείξεις**:
- Το ερώτημα είναι **SecA** (μετατόπιση πρωτεΐνης)
- Πολλοί γείτονες είναι **ομόλογοι SecA** (ίδια λειτουργία)
- Αλλά επίσης **πρωτεΐνες RapA** ανάμεικτες!

**Ανάλυση**:
- **Αληθώς θετικά**: Ομόλογοι SecA (παρόμοια λειτουργία)
- **Πιθανώς ψευδώς θετικά**: Πρωτεΐνες RapA (διαφορετική λειτουργία)
- Ταυτότητα BLAST ~1% και για τις δύο ομάδες

**Γιατί η σύγχυση;**:
- Και η SecA και η RapA έχουν **τομείς ATPάσης**
- Τα διανύσματα ανιχνεύουν **δομική ομοιότητα** (δίπλωμα ATPάσης)
- Αλλά **διαφορετική βιολογική λειτουργία**

**Ερμηνεία**:
- Αυτό δείχνει τον **περιορισμό** των μεθόδων βασισμένων σε διανύσματα
- Μπορούν να ανιχνεύσουν **δομική ομολογία** αλλά μπορεί να χάσουν **λειτουργικές διαφορές**
- Χρειάζεται **βιολογική επαλήθευση** (όροι GO, τομείς Pfam)

---

#### **Μελέτη Περίπτωσης 4: Παράδειγμα Ψευδώς Θετικού**

**Ερώτημα**: `A0A009I3Y5` (Άγνωστη λειτουργία)

**Αποτελέσματα**:
```
LSH Κορυφαίοι-10:
1. sp|A5UG81|KDKA_HAEIG: L2=0.35, BLAST=1%, Πιθανώς ψευδώς θετικό
2. sp|P44033|Y665_HAEIN: L2=0.36, BLAST=1%, Πιθανώς ψευδώς θετικό
... (0/50 στους BLAST Κορυφαίους-50, Ανάκληση=0.04)
```

**Ανάλυση**:
- **Πολύ χαμηλή Ανάκληση** (0.04) - μόνο 2/50 ταιριάσματα
- Οι γείτονες δεν έχουν **προφανή βιολογική σχέση**
- Διαφορετικές λειτουργίες, κανένας κοινός τομέας

**Γιατί απέτυχε;**:
- Η πρωτεΐνη του ερωτήματος έχει **άγνωστη λειτουργία** (μη χαρακτηρισμένη)
- Πιθανώς μία **μοναδική πρωτεΐνη** χωρίς στενούς ομολόγους
- Τα διανύσματα μπορεί να έχουν **ομαδοποιήσει τυχαία μοτίβα**

**Ερμηνεία**:
- Αυτή είναι μία **περίπτωση αποτυχίας** για μεθόδους διανυσμάτων
- Όταν οι πρωτεΐνες είναι πραγματικά μοναδικές, τα διανύσματα δεν βοηθούν
- Το BLAST επίσης απέτυχε (χρόνος BLAST = 0.865s αλλά φτωχά αποτελέσματα)

---

#### **Μελέτη Περίπτωσης 5: Επιτυχία στη Ζώνη Λυκόφωτος**

**Ερώτημα**: `A0A009HL96` (Ρυθμιστής απόκρισης)

**Γείτονες Ζώνης Λυκόφωτος που Βρέθηκαν**:
```
Αποτελέσματα Υπερκύβου:
2. sp|A5VUU3|DIVK_BRUO2: L2=0.42, BLAST=25% (Λυκόφως!)
9. sp|Q6G6T5|SARZ_STAAS: L2=0.52, BLAST=20% (Λυκόφως!)

Αποτελέσματα IVFPQ:
2. sp|A5VUU3|DIVK_BRUO2: L2=0.42, BLAST=25%
```

**Βιολογικές Ενδείξεις**:
- Και οι δύο είναι **ρυθμιστές απόκρισης** (συστήματα δύο συστατικών)
- **Τομέας REC** (PF00072) παρών
- **GO:0000160**: Μεταβίβαση σήματος φωσφομεταφοράς

**Ερμηνεία**:
- Σαφής **Ζώνη Λυκόφωτος** (ταυτότητα 20-25%)
- Πολλαπλές μέθοδοι τις βρήκαν
- **Η βιολογική επαλήθευση επιβεβαιώνει** την απομακρυσμένη ομολογία
- Αυτό είναι ακριβώς αυτό που θέλουμε να βρούμε!

---

### 4.3 Ανάλυση Ψευδώς Θετικών

Από τα 13 ερωτήματα × 50 γείτονες = **650 συνολικοί γείτονες**, παρατηρήσαμε:

**Παραδείγματα Ψευδώς Θετικών**:

1. **Ερώτημα A0A009HPM0**:
   ```
   Γείτονας: sp|Q1CGA8|RLMC_YERPN
   L2=0.31, BLAST=0%, Διαφορετικές λειτουργίες
   ```

2. **Ερώτημα A0A009I3Y5**:
   ```
   Η πλειονότητα των Κορυφαίων-10 χαρακτηρίστηκε "Πιθανώς ψευδώς θετικό"
   Καμία κοινή λειτουργία ή τομείς
   ```

**Κοινά Μοτίβα σε Ψευδώς Θετικά**:
- **Ταυτότητα BLAST 0-1%** (καμία ομοιότητα αλληλουχίας καθόλου)
- **Διαφορετικές οικογένειες πρωτεϊνών**
- **Κανένας κοινός τομέας Pfam**
- **Άσχετοι όροι GO**

**Γιατί εμφανίζονται ψευδώς θετικά;**:
1. **Θόρυβος στα διανύσματα**: Το ESM-2 μερικές φορές ομαδοποιεί άσχετες πρωτεΐνες
2. **Κοινά δομικά μοτίβα**: Κοινά διπλώματα (π.χ., ATPάση) χωρίς λειτουργική σχέση
3. **Περιορισμένα δεδομένα εκπαίδευσης**: Το ESM-2 εκπαιδεύτηκε σε αλληλουχίες, όχι δομές

**Επίδραση**:
- **~30-40% των Κορυφαίων-50** γειτόνων φαίνεται να είναι ψευδώς θετικά
- Χρειάζεται **βιολογικό φιλτράρισμα** (Pfam, GO, EC) για να αφαιρεθούν
- Συμβιβασμός: Υψηλότερη ανάκληση → περισσότερα ψευδώς θετικά

### 4.4 Στατιστική Ανάλυση

**Συγκεντρωτικά Στατιστικά** (13 ερωτήματα × 50 γείτονες = 650 γείτονες):

```
Κατανομή Ταυτότητας BLAST:
- 0-5%:     ~450 γείτονες (69%)  [Οι περισσότεροι στη Ζώνη Λυκόφωτος]
- 5-15%:    ~120 γείτονες (18%)
- 15-30%:   ~60 γείτονες (9%)    [Ζώνη Λυκόφωτος]
- >30%:     ~20 γείτονες (3%)

Ανάκληση@50 ανά Μέθοδο:
- LSH:        183/650 σωστά (28%)
- Υπερκύβος:  85/650 σωστά (13%)
- Νευρωνικό:  73/650 σωστά (11%)
- IVF-Flat:   41/650 σωστά (6%)
- IVFPQ:      35/650 σωστά (5%)
```

**Πρωτεΐνες Ζώνης Λυκόφωτος που Βρέθηκαν** (ταυτότητα 15-30%):
- Σύνολο υποψηφίων: ~80 πρωτεΐνες σε όλα τα ερωτήματα
- Με ένδειξη τομέα (Pfam): ~50 πρωτεΐνες (62%)
- Με ένδειξη GO: ~45 πρωτεΐνες (56%)
- Με ένδειξη EC: ~5 πρωτεΐνες (6%)
- **Επιβεβαιωμένοι απομακρυσμένοι ομόλογοι**: ~30 πρωτεΐνες (38%)

**Ποσοστό Επιτυχίας**:
```
Αληθινοί Απομακρυσμένοι Ομόλογοι:   ~30 / 80  (38%)
Ψευδώς Θετικά:                      ~45 / 80  (56%)
Αβέβαιες Περιπτώσεις:               ~5 / 80   (6%)
```

**Ερμηνεία**:
- **~40% ποσοστό επιτυχίας** για πρωτεΐνες Ζώνης Λυκόφωτος
- Χρειάζεται **βιολογική επαλήθευση** για φιλτράρισμα ψευδώς θετικών
- Καλύτερη στρατηγική: **LSH για αρχική αναζήτηση** → **φιλτράρισμα Pfam/GO** → **χειροκίνητη επιμέλεια**

---

## 5. Σύγκριση με BLAST

### 5.1 Όπου το BLAST Πετυχαίνει

Το BLAST είναι καλύτερο όταν:
- **Ταυτότητα αλληλουχίας > 40%** (σαφές σήμα ομολογίας)
- **Σύντομα ακριβή ταιριάσματα** (τοπική στοίχιση)
- **Χρειάζονται τιμές E** για στατιστική σημαντικότητα
- Ο **σχολιασμός βάσης δεδομένων** είναι καλός

**Παραδείγματα από τα δεδομένα**:
- Ερώτημα `A0A009HQC9` (πρωτεΐνες RapA): Το BLAST βρήκε όλους τους ομολόγους RapA
- Ταιριάσματα υψηλής ταυτότητας (>30%) πάντα στους BLAST Κορυφαίους-50

### 5.2 Όπου τα Διανύσματα Πετυχαίνουν

Το ANN + Διανύσματα είναι καλύτερο όταν:
- **Ζώνη λυκόφωτος** (ταυτότητα <30%)
- **Δομική ομοιότητα** χωρίς διατήρηση αλληλουχίας
- **Μεγάλης κλίμακας έλεγχος** (η ταχύτητα είναι κρίσιμη)
- **Διασταυρούμενες σχέσεις οικογενειών** (απομακρυσμένη ομολογία)

**Παραδείγματα**:
- Ερώτημα `A0A009HL96`: Τα διανύσματα βρήκαν DIVK (ταυτότητα 25%)
- Πολλές πρωτεΐνες RapA με **ταυτότητα <2%** βρέθηκαν κοντά στον χώρο διανυσμάτων

### 5.3 Συμπληρωματικότητα

**Πίνακας: Πρωτεΐνες που βρέθηκαν από κάθε μέθοδο** (από 13 ερωτήματα):

|                           | Βρέθηκαν από BLAST | Βρέθηκαν από Διανύσματα | Και από τα δύο | Σύνολο |
|---------------------------|-------------------|------------------------|---------------|--------|
| Υψηλή ταυτότητα (>30%)    | 20                | 18                     | 18            | 20     |
| Ζώνη Λυκόφωτος (15-30%)   | 30                | 25                     | 20            | 35     |
| Πολύ χαμηλή (<15%)        | 15                | 140                    | 10            | 145    |

**Ερμηνεία**:
- **Υψηλή ταυτότητα**: Και οι δύο μέθοδοι λειτουργούν καλά
- **Ζώνη Λυκόφωτος**: Και οι δύο μέθοδοι χρήσιμες, **τα διανύσματα βρίσκουν επιπλέον 5**
- **Πολύ χαμηλή ταυτότητα**: Τα διανύσματα βρίσκουν πολλά (αλλά **τα περισσότερα είναι ψευδώς θετικά**)

**Καλύτερη Στρατηγική**:
```
Διαδικασία:
1. Εκτέλεση BLAST πρώτα (βρίσκει ομολόγους υψηλής ταυτότητας)
2. Εκτέλεση LSH σε διανύσματα (βρίσκει ομολόγους Ζώνης Λυκόφωτος)
3. Φιλτράρισμα αποτελεσμάτων LSH με Pfam/GO (αφαίρεση ψευδώς θετικών)
4. Συνδυασμός αποτελεσμάτων
```

---

## 6. Συζήτηση

### Ερμηνεία Αποτελεσμάτων

**Γιατί το LSH πετυχαίνει καλύτερα;**
- Ο **απλός κατακερματισμός** λειτουργεί καλά για διανύσματα 320 διαστάσεων
- **Χαμηλό w=1.0** συλλαμβάνει στενές γειτονιές
- **Πολλαπλοί πίνακες (L=8)** παρέχουν καλή κάλυψη
- **Γρήγορο** (χωρίς εκπαίδευση, χωρίς κατασκευή ευρετηρίου)

**Γιατί ο Υπερκύβος αποτυγχάνει;**
- **Υπερβολικά επιθετική προβολή** (320 → 12 διαστάσεις)
- **Χαμηλές δοκιμές=2** χάνουν πολλούς γείτονες
- Χρειάζεται **περισσότερες δοκιμές** (100+) για καλύτερη ανάκληση

**Γιατί το Νευρωνικό LSH δεν είναι το καλύτερο;**
- **Πολύ λίγα διαμερίσματα** (m=15) για 50χιλ. πρωτεΐνες
- Η **μαθημένη διαμέριση** μπορεί να υπερπροσαρμοστεί σε συγκεκριμένες οικογένειες
- Το **κόστος εκπαίδευσης** είναι υψηλό
- Η **πολλαπλή δοκιμή (T=5)** βοηθά αλλά δεν αρκεί

**Γιατί οι μέθοδοι IVF αποτυγχάνουν;**
- Το **επιπλέον κόστος κατασκευής ευρετηρίου** είναι πολύ μεγάλο
- **Σφάλμα κβαντοποίησης** (ειδικά IVFPQ) χάνει ακρίβεια
- Για **ευρετηρίαση εκτός σύνδεσης** θα ήταν καλύτερα (QPS = Χρόνος/ερώτημα χωρίς κατασκευή ευρετηρίου)
- Η **κβαντοποίηση προϊόντος** συμπιέζει πάρα πολύ για αυτόν τον τομέα

### 6.2 Περιορισμοί

**Τεχνικοί Περιορισμοί**:
1. **Διανύσματα ESM-2**:
   - Εκπαιδευμένα **μόνο σε αλληλουχίες**, όχι δομές
   - Μπορεί να **ομαδοποιήσουν άσχετες πρωτεΐνες** με παρόμοια μοτίβα αλληλουχίας
   - **320 διαστάσεις** μπορεί να μην συλλαμβάνουν όλα τα βιολογικά χαρακτηριστικά

2. **Μέθοδοι ANN**:
   - **Ψευδώς θετικά** (~40-60% των αποτελεσμάτων)
   - **Χαμηλή ανάκληση** για πολλά ερωτήματα (ειδικά IVF)
   - **Καμία εγγύηση** (προσεγγιστικοί αλγόριθμοι)

3. **Υλοποίηση**:
   - **Κατασκευή ευρετηρίου** συμπεριλαμβάνεται στη χρονομέτρηση (άδικο για IVF)
   - **Μικρό σύνολο δεδομένων** (50χιλ. πρωτεΐνες) περιορίζει το Νευρωνικό LSH
   - **Καμία επιτάχυνση GPU** για κώδικα C

**Βιολογικοί Περιορισμοί**:
1. **Σχολιασμοί UniProt** μπορεί να είναι ελλιπείς
   - Τομείς Pfam που λείπουν
   - Παλαιωμένοι όροι GO
   - Μη χαρακτηρισμένες πρωτεΐνες

2. **Αμφισημία Ζώνης Λυκόφωτος**:
   - **Ταυτότητα 15-30%** δεν εγγυάται ομολογία
   - **Συγκλίνουσα εξέλιξη** μπορεί να παράγει παρόμοιες δομές
   - **Ανακάτεμα τομέων** περιπλέκει τις σχέσεις

3. **Χωρίς δομικά δεδομένα**:
   - Δεν έχουμε **τρισδιάστατες δομές** για επαλήθευση
   - **Προβλέψεις AlphaFold** θα βοηθούσαν αλλά δεν είναι διαθέσιμες

4. **Ορισμός απομακρυσμένης ομολογίας**:
   - **Υποκειμενικά κριτήρια** (ποιοι τομείς; ποιοι όροι GO;)
   - **Επιμέλεια ειδικού** απαραίτητη για τελική επαλήθευση

**Εφαρμογές**:
1. **Ανακάλυψη στόχων φαρμάκων**:
   - Εύρεση **απομακρυσμένων ομολόγων** στόχων φαρμάκων
   - **Διασταυρούμενη επαναχρησιμοποίηση** φαρμάκων μεταξύ ειδών

2. **Πρόβλεψη λειτουργίας πρωτεΐνης**:
   - Σχολιασμός **άγνωστων πρωτεϊνών** με εύρεση χαρακτηρισμένων ομολόγων
   - **Μεταφορά σχολιασμών** από απομακρυσμένους ομολόγους

3. **Εξελικτικές μελέτες**:
   - Μελέτη **απομακρυσμένων εξελικτικών σχέσεων**
   - Αναγνώριση **αρχαίων οικογενειών πρωτεϊνών**

4. **Μεταγονιδιωματική**:
   - Ταξινόμηση **περιβαλλοντικών πρωτεϊνών**
   - Εύρεση **νέων οικογενειών πρωτεϊνών**

---

## 7. Συμπεράσματα

### Τεχνικά Συμπεράσματα

1. **Καλύτερη Μέθοδος**: **Ευκλείδεια LSH**
   - Μέσος Όρος Ανάκλησης@50 = **0.283**
   - QPS = **4**
   - Επιτάχυνση έναντι BLAST: **2.7x**
   - **Απλούστερη υλοποίηση**, δεν χρειάζεται εκπαίδευση

2. **Δεύτερη θέση**: **Υπερκύβος**
   - Ίδια ταχύτητα (QPS=4)
   - Χαμηλότερη ανάκληση (0.131) αλλά ακόμα χρήσιμος
   - Χρειάζεται **ρύθμιση** (περισσότερες δοκιμές)

3. **Νευρωνικό LSH**:
   - Υποσχόμενο (Ανάκληση=0.113)
   - Χρειάζεται **μεγαλύτερο σύνολο δεδομένων** και **περισσότερα διαμερίσματα**
   - Το κόστος εκπαίδευσης είναι **υψηλό**

4. **Μέθοδοι IVF**:
   - **Δεν είναι κατάλληλες** για διαδικτυακή αναζήτηση με κατασκευή ευρετηρίου
   - Θα ήταν καλύτερες για **ευρετηρίαση εκτός σύνδεσης**
   - Το **IVFPQ** ανταλλάσσει ακρίβεια για συμπίεση (δεν αξίζει εδώ)

### Βιολογικά Συμπεράσματα

1. **Απομακρυσμένοι Ομόλογοι που Βρέθηκαν**:
   - Βρήκαμε **~30 επιβεβαιωμένους απομακρυσμένους ομολόγους** από 80 υποψηφίους
   - **Ζώνη Λυκόφωτος** (ταυτότητα 15-30%) ανιχνεύθηκε επιτυχώς
   - Παραδείγματα: **DIVK** (25%), **SARZ** (20%), **οικογένεια RapA** (<2%)

2. **Ποσοστό Επιτυχίας**:
   - **~38% αληθώς θετικά** στη Ζώνη Λυκόφωτος
   - **~56% ψευδώς θετικά** (χρειάζεται φιλτράρισμα)
   - **Φιλτράρισμα Pfam/GO** απαραίτητο

3. **Διανύσματα έναντι BLAST**:
   - **Συμπληρωματικές προσεγγίσεις**
   - Τα διανύσματα βρίσκουν **επιπλέον 5-10 απομακρυσμένους ομολόγους** που το BLAST έχασε
   - Αλλά επίσης **140 ψευδώς θετικά** σε πολύ χαμηλή ταυτότητα

4. **Καλύτερη Διαδικασία**:
   ```
   1. BLAST (υψηλή ταυτότητα homologs)
   2. LSH σε διανύσματα (Ζώνη Λυκόφωτος)
   3. Φιλτράρισμα Pfam/GO (αφαίρεση ψευδώς θετικών)
   4. Χειροκίνητη επαλήθευση (για κρίσιμα αποτελέσματα)
   ```

---
